<!DOCTYPE html>
<html lang="en">
<head>
  <style>
    @media print {
      #backToReportBtn {
        display: none !important;
      }
    }
  </style>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Report Card</title>
  <link rel="icon" type="image/png" href="Badge.png" />
  <link rel="stylesheet" href="report.css" />
</head>
<body>
  <div class="report-container">
  <button id="backToReportBtn" class="back-btn" style="display:none;">Back to Report Dashboard</button>
    <!-- ðŸ“‹ Dashboard Overview Section -->
    <div id="dashboardOverview" class="dashboard-overview">
      <h2>Report Dashboard Overview</h2>
      <div class="dashboard-cards">
        <div class="dashboard-card" data-section="reportSection">
          <span>View Report Card</span>
        </div>
        <div class="dashboard-card" data-section="filters">
          <span>Filter Reports</span>
        </div>
        <div class="dashboard-card" data-section="student-selector">
          <span>Select Student</span>
        </div>
      </div>
    </div>


    <!-- ðŸ”½ Student Selector (with Filters) -->
    <div class="student-selector no-print">
      <label for="classSelect">Select Class:</label>
      <select id="classSelect">
        <option value="">-- Select Class --</option>
      </select>
      <label for="studentSearch">Search Student:</label>
      <input type="text" id="studentSearch" placeholder="Type to search..." oninput="filterStudentDropdown()" />
      <label for="studentSelect">Select Student:</label>
      <select id="studentSelect" onchange="loadReportForStudent()">
        <option value="">-- Select --</option>
      </select>
      <label for="termFilter">Term:</label>
      <select id="termFilter">
        <option value="">-- Select Term --</option>
        <option value="1st Term">1st Term</option>
        <option value="2nd Term">2nd Term</option>
        <option value="3rd Term">3rd Term</option>
      </select>
      <input id="yearFilter" placeholder="Academic Year (e.g. 2025/2026)">
      <button id="bulkPrintBtn" type="button">Print Selected Class Reports</button>
    </div>

    <div id="reportSection">
      <!-- ðŸ« Header with Logo and Student Photo -->
      <div class="report-header">
        <div class="header-left">
          <img src="Badge.png" alt="School Logo" class="school-logo" />
        </div>
        <div class="header-center">
          <div class="ges-header">GHANA EDUCATION SERVICE</div>
          <div class="school-name">Nkawkaw Nsuta M/A 'B' Basic School</div>
          <h2>End of Term Report</h2>
        </div>
        <div class="header-right">
          <img id="studentPhoto" src="" alt="Student Photo" class="student-photo" />
        </div>
      </div>

      <!-- ðŸ‘¤ Student Info -->
      <section class="student-info">
        <table style="width:100%;border-collapse:collapse;margin-bottom:1em;">
          <tr>
            <td><strong>Name:</strong></td>
            <td><span id="studentName">â€”</span></td>
            <td><strong>Class:</strong></td>
            <td><span id="studentClass">â€”</span></td>
            <td><strong>Term:</strong></td>
            <td><span id="term">â€”</span></td>
          </tr>
          <tr>
            <td><strong>Academic Year:</strong></td>
            <td><span id="year">â€”</span></td>
            <td><strong>Class Size:</strong></td>
            <td><span id="totalInClass">â€”</span></td>
            <td><strong>Position:</strong></td>
            <td><span id="position">â€”</span></td>
          </tr>
          <tr>
            <td><strong>Date of Vacation:</strong></td>
            <td><span id="vacationDate">â€”</span></td>
            <td><strong>Reopening Date:</strong></td>
            <td><span id="reopenDate">â€”</span></td>
            <td></td>
            <td></td>
          </tr>
        </table>
      </section>

      <!-- ðŸ“Š Score Table -->
      <section class="score-table">
        <table>
          <thead>
            <tr>
              <th colspan="7" class="results-details-header">RESULTS DETAILS</th>
            </tr>
            <tr>
              <th>Subject</th>
              <th>Class Score</th>
              <th>Exam Score</th>
              <th>Total</th>
              <th>Grade Point</th>
              <th>Remark</th>
              <th>Position</th>
            </tr>
          </thead>
          <tbody id="scoreBody">
            <!-- Dynamic rows -->
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4"><strong>Total Score</strong></td>
              <td id="totalScore">0</td>
              <td colspan="2"></td>
            </tr>
            <tr>
              <td colspan="4"><strong>Average</strong></td>
              <td id="averageScore">0</td>
              <td colspan="2"></td>
            </tr>
          </tfoot>
        </table>
      </section>

      <!-- ðŸ“ Remarks -->
      <section class="remarks">
        <table style="width:100%;border-collapse:collapse;margin-bottom:1em;">
          <tr>
            <td><strong>Total Attendance:</strong></td>
            <td><span id="totalAttendance">â€”</span></td>
            <td><strong>Out of:</strong></td>
            <td><span id="actualAttendance">â€”</span></td>
            <td><strong>Promoted to:</strong></td>
            <td><span id="promotedTo">â€”</span></td>
          </tr>
          <tr>
            <td><strong>Interest/Talent:</strong></td>
            <td colspan="2"><span id="studentInterest">â€”</span></td>
            <td><strong>Conduct:</strong></td>
            <td colspan="2"><span id="studentConduct">â€”</span></td>
          </tr>
        </table>
        <p><strong>Teacher's Remark:</strong> <span id="teacherRemark">â€”</span></p>
        <div class="approval-columns">
          <div class="approval-col">
            <div class="approval-label">Class Teacher's Approval</div>
            <div class="signature-line"></div>
          </div>
          <div class="approval-col">
            <div class="approval-label">Headteacher's Approval</div>
            <div class="signature-line"></div>
          </div>
        </div>
      </section>

      <!-- ðŸ–¨ï¸ Print Button -->
      <footer class="report-footer">
        <div class="school-motto-footer">"KNOWLEDGE IS POWER"</div>
        <button onclick="window.print()">Print Report</button>
        <button id="sendResultBtn" type="button">Send Result to Student</button>
      </footer>
    </div>
  </div>

  <!-- Watermark -->
  <div class="watermark" style="display:none;">
    <img src="Badge.png" alt="School Logo Watermark" />
  </div>

  <!-- Supabase + Logic -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="toasts.js"></script>
  <script src="report.js"></script>
</body>
</html>