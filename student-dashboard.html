<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Dashboard</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="student-dashboard.css" />
</head>
<body>
  <div class="student-dashboard-bg"></div>
  <div class="dashboard-bg-overlay"></div>
  <button id="logoutBtn" class="logout-btn">Logout</button>
  <div class="school-header">
  <img src="Badge.png" alt="School Logo" class="school-logo" />
  <h1 class="school-title">Nkawkaw Nsuta M/A 'B' Basic School</h1>
  </div>
  <div class="dashboard-container">

    <!-- Welcome and Actions -->
    <div class="student-header">
      <h2 id="welcomeMessage">Welcome, [Student Name]</h2>
      <div class="student-header-actions">
        <button id="aboutMeBtn" class="about-me-btn">About Me</button>
        <button id="changePinBtn" class="change-pin-btn">Change PIN</button>
      </div>
    </div>
    <!-- About Me Modal -->
    <div id="aboutMeModal" class="modal hidden">
      <div class="modal-content">
        <span class="close" id="closeAboutMe" onclick="closeAboutMeModal()">&times;</span>
        <h2 class="modal-title">About Me</h2>
        <div id="aboutMeContent">
          <div class="student-details-readonly">
            <p id="studentFirstName"><strong>First Name:</strong> </p>
            <p id="studentSurname"><strong>Surname:</strong> </p>
            <p id="studentLocation"><strong>Location:</strong> </p>
            <p id="studentDob"><strong>Date of Birth:</strong> </p>
            <p id="studentNhis"><strong>NHIS Number:</strong> </p>
            <p id="studentGender"><strong>Gender:</strong> </p>
            <p id="studentClass"><strong>Class:</strong> </p>
            <p id="studentParentName"><strong>Parent/Guardian Name:</strong> </p>
            <p id="studentParentContact"><strong>Parent/Guardian Number:</strong> </p>
          </div>
          <img id="studentPhoto" class="passport-photo" src="" alt="Student Photo" style="display:block;margin:1rem auto;max-width:120px;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,0.07);" />
        </div>
      </div>
    </div>
    <div id="changePinModal" class="modal hidden">
      <div class="modal-content">
        <span class="close" id="closeChangePin" onclick="closeChangePinModal()">&times;</span>
        <h3 class="modal-title">Change Login PIN</h3>
        <form id="changePinForm">
          <label for="oldPinInput">Current PIN:</label>
          <input type="password" id="oldPinInput" required minlength="4" maxlength="8" />
          <label for="newPinInput">New PIN:</label>
          <input type="password" id="newPinInput" required minlength="4" maxlength="8" />
          <label for="confirmPinInput">Confirm New PIN:</label>
          <input type="password" id="confirmPinInput" required minlength="4" maxlength="8" />
          <button type="submit" class="modal-btn primary">Change PIN</button>
          <button type="button" onclick="closeChangePinModal()" class="modal-btn secondary">Cancel</button>
          <div id="changePinStatus" class="modal-status"></div>
        </form>
      </div>
    </div>

    <!-- Dashboard Overview Cards -->
    <div id="dashboardOverview" class="dashboard-overview">
  <!-- Removed View My Details card -->
  <div class="dashboard-card" data-section="assignmentsSection">Assignments</div>
  <div class="dashboard-card" data-section="resultsSection">Results</div>
  <div class="dashboard-card" data-section="submissionsSection">Submissions</div>
  <div class="dashboard-card" data-section="resourcesSection">Resources</div>
  <div class="dashboard-card" data-section="contactTeacherSection">Contact Teacher</div>
  <div class="dashboard-card" data-section="resourceRequestSection">Request Resource</div>
  <div class="dashboard-card" data-section="motivationSection">Motivation</div>
    </div>

    <!-- ðŸ“¥ Assignments Section -->
  <div id="assignmentsSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Assignments</h3>
      <table>
        <thead>
          <tr>
            <th>Teacher</th>
            <th>Subject</th>
            <th>Title</th>
            <th>Term</th>
            <th>Year</th>
            <th>Status</th>
            <th>Download</th>
            <th>Teacher Feedback</th>
          </tr>
        </thead>
        <tbody id="assignmentTableBody">
          <!-- Dynamic rows -->
        </tbody>
      </table>

      <label for="assignmentSelect">Select Assignment:</label>
      <select id="assignmentSelect">
        <option value="">-- Choose --</option>
      </select>

      <label for="submissionFile">Upload Your Work:</label>
      <input type="file" id="submissionFile" />

      <button onclick="submitAssignment()">Submit Assignment</button>
    </div>

    <!-- ðŸ“ˆ Results Section -->
  <div id="resultsSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Released Results</h3>

      <!-- ðŸ“… Term and Year Filters -->
      <div class="filters">
        <label for="termFilter">Term:</label>
        <select id="termFilter">
          <option value="">-- Select Term --</option>
          <option>1st Term</option>
          <option>2nd Term</option>
          <option>3rd Term</option>
        </select>
        <label for="yearFilter">Year:</label>
        <input type="text" id="yearFilter" placeholder="e.g. 2025/2026" />
        <button onclick="loadReleasedResults()">View Results</button>
      </div>

      <table id="releasedResultsTable">
        <thead>
          <tr>
            <th>Subject</th>
            <th>Class Score (SBA)</th>
            <th>Exam Score</th>
            <th>Total</th>
            <th>Teacher Feedback</th>
          </tr>
        </thead>
        <tbody id="releasedResultsTableBody">
          <!-- Results will be dynamically inserted here -->
        </tbody>
      </table>

      <!-- ðŸ“Š Performance Chart -->
      <div class="performance-chart">
        <canvas id="scoreChart"></canvas>
      </div>
    </div>

    <!-- ðŸ“¥ Submissions Section -->
  <div id="submissionsSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Submission History</h3>
      <table>
        <thead>
          <tr>
            <th>Assignment</th>
            <th>Submitted At</th>
            <th>File</th>
          </tr>
        </thead>
        <tbody id="submissionTableBody">
          <!-- Dynamic rows -->
        </tbody>
      </table>
    </div>

    <!-- ðŸ“š Resources Section -->
  <div id="resourcesSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Study Resources</h3>
  <div class="resource-filter-bar">
        <label for="resourceTypeFilter">Type:</label>
        <select id="resourceTypeFilter" onchange="filterResources()">
          <option value="">All</option>
          <option value="note">Notes</option>
          <option value="video">Videos</option>
          <option value="quiz">Quizzes</option>
          <option value="other">Other</option>
        </select>
  <input id="resourceSearch" type="text" placeholder="Search resources..." oninput="filterResources()" class="resource-search" />
      </div>
      <ul id="resourceList">
        <!-- Links to PDFs, videos, quizzes -->
      </ul>
  <div id="recommendedResources" class="recommended-resources">
        <h4>Recommended for You</h4>
        <ul id="recommendedList"></ul>
      </div>
    </div>

    <!-- Contact Teacher Section -->
  <div id="contactTeacherSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Contact Teacher</h3>
      <form id="contactTeacherForm">
        <label for="teacherSelect">Select Teacher:</label>
        <select id="teacherSelect"></select>
        <label for="messageToTeacher">Message:</label>
        <textarea id="messageToTeacher" rows="4" placeholder="Type your question or message..."></textarea>
        <button type="button" onclick="sendMessageToTeacher()">Send</button>
      </form>
      <div id="teacherMessageStatus"></div>
    </div>

    <!-- Resource Request Section -->
  <div id="resourceRequestSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Request Study Resource</h3>
      <form id="resourceRequestForm">
  <label for="teacherSelectResource">Teacher:</label>
  <select id="teacherSelectResource">
    <option value="">-- Select Teacher --</option>
    <!-- Teachers will be populated by JS -->
  </select>
  <label for="resourceTopic">Topic/Resource Needed:</label>
  <input type="text" id="resourceTopic" placeholder="e.g. Algebra, Essay Writing" />
  <label for="resourceReason">Reason (optional):</label>
  <input type="text" id="resourceReason" placeholder="Why do you need this resource?" />
  <button type="button" onclick="sendResourceRequest()">Request</button>
      </form>
      <div id="resourceRequestStatus"></div>
    </div>

    <!-- Motivation Section -->
  <div id="motivationSection" class="tab-section">
    <button class="back-to-dashboard" onclick="showDashboardOverview()">&larr; Back to Dashboard</button>
      <h3>Motivational Messages & Announcements</h3>
      <ul id="motivationList"></ul>
    </div>

    <!-- Study Bot Section removed -->
  </div>

  <!-- Supabase + Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="student-dashboard.js"></script>
    <script src="router.js"></script>
<script>
  // Show dashboard overview by default
  function showDashboardOverview() {
    document.getElementById('dashboardOverview').style.display = 'grid';
    document.querySelectorAll('.tab-section').forEach(section => {
      section.style.display = 'none';
    });
  }
  // Show a specific section and hide dashboard overview
  function showTabSection(tabId) {
    document.getElementById('dashboardOverview').style.display = 'none';
    document.querySelectorAll('.tab-section').forEach(section => {
      section.style.display = 'none';
    });
    var tabSection = document.getElementById(tabId);
    if (tabSection) {
      tabSection.style.display = 'block';
    } else {
      console.warn('Tab section not found:', tabId);
    }
  }
  // Add click listeners to dashboard cards
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.dashboard-card').forEach(card => {
      card.onclick = function() {
        showTabSection(card.getAttribute('data-section'));
      };
    });
    showDashboardOverview();
  });
</script>
<script>
  // Add logout logic to redirect to login.html
  const logoutBtn = document.getElementById('logoutBtn');
  if (logoutBtn) {
    logoutBtn.onclick = function() {
      sessionStorage.clear();
      localStorage.clear();
      window.location.href = 'login.html';
    };
  }
</script>
</body>
</html>